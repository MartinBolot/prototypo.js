define(['./Point.js'], function($__0) {
  "use strict";
  if (!$__0 || !$__0.__esModule)
    $__0 = {default: $__0};
  var Point = $__0.default;
  function Node(args) {
    var coords;
    if (args && (args.x !== undefined || args.y !== undefined)) {
      coords = {
        x: args.x,
        y: args.y
      };
    }
    Point.prototype.constructor.apply(this, [coords]);
    this.lCtrl = new Point(args && args.lCtrl);
    this.lCtrl.tags.add('control');
    this.rCtrl = new Point(args && args.rCtrl);
    this.rCtrl.tags.add('control');
    this.src = args && args.src;
  }
  Node.prototype = Object.create(Point.prototype);
  Node.prototype.constructor = Node;
  Node.prototype.transform = function(m, withCtrls) {
    var coords0 = this.coords[0];
    this.coords[0] = m[0] * coords0 + m[2] * this.coords[1] + m[4];
    this.coords[1] = m[1] * coords0 + m[3] * this.coords[1] + m[5];
    if (withCtrls) {
      coords0 = this.lCtrl.coords[0];
      this.lCtrl.coords[0] = m[0] * coords0 + m[2] * this.lCtrl.coords[1] + m[4];
      this.lCtrl.coords[1] = m[1] * coords0 + m[3] * this.lCtrl.coords[1] + m[5];
      coords0 = this.rCtrl.coords[0];
      this.rCtrl.coords[0] = m[0] * coords0 + m[2] * this.rCtrl.coords[1] + m[4];
      this.rCtrl.coords[1] = m[1] * coords0 + m[3] * this.rCtrl.coords[1] + m[5];
    }
    return this;
  };
  Node.prototype.update = function(params, contours, anchors, nodes) {
    for (var i in this.src) {
      var attr = this.src[i];
      if (typeof attr === 'object' && attr.updater) {
        var args = [contours, anchors, nodes];
        attr.parameters.forEach((function(name) {
          return args.push(params[name]);
        }));
        this[i] = attr.updater.apply({}, args);
      }
      if (i === 'onLine') {
        var knownCoord = this.src.x === undefined ? 'y' : 'x',
            p1 = nodes[this.src.onLine[0].operation.replace(/[^\d]/g, '')],
            p2 = nodes[this.src.onLine[1].operation.replace(/[^\d]/g, '')];
        this.onLine(knownCoord, p1, p2);
      }
    }
  };
  var $__default = Node;
  return {
    get default() {
      return $__default;
    },
    __esModule: true
  };
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci82IiwiY2xhc3Nlcy9Ob2RlLmpzIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzUiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNCIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8wIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMSIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8yIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEtBQUssQUFBQyxFQ0FZLFlBQVcsRUNBN0IsVUFBUyxJQUFnQjs7QUNBekIsS0FBSSxLQUFpQixHQUFLLEVBQUMsZUFBMkI7QUFDMUMsU0FBb0IsRUFBQyxPQUFNLE1BQW1CLENBQUMsQ0FBQTtBQUFBLElGRHBELE1BQUk7QUFFWCxTQUFTLEtBQUcsQ0FBRyxJQUFHLENBQUk7QUFDckIsQUFBSSxNQUFBLENBQUEsTUFBSyxDQUFDO0FBQ1YsT0FBSyxJQUFHLEdBQUssRUFBRSxJQUFHLEVBQUUsSUFBTSxVQUFRLENBQUEsRUFBSyxDQUFBLElBQUcsRUFBRSxJQUFNLFVBQVEsQ0FBRSxDQUFJO0FBQy9ELFdBQUssRUFBSTtBQUNSLFFBQUEsQ0FBRyxDQUFBLElBQUcsRUFBRTtBQUNSLFFBQUEsQ0FBRyxDQUFBLElBQUcsRUFBRTtBQUFBLE1BQ1QsQ0FBQztJQUNGO0FBQUEsQUFFQSxRQUFJLFVBQVUsWUFBWSxNQUFNLEFBQUMsQ0FBRSxJQUFHLENBQUcsRUFBRSxNQUFLLENBQUUsQ0FBRSxDQUFDO0FBRXJELE9BQUcsTUFBTSxFQUFJLElBQUksTUFBSSxBQUFDLENBQUUsSUFBRyxHQUFLLENBQUEsSUFBRyxNQUFNLENBQUUsQ0FBQztBQUM1QyxPQUFHLE1BQU0sS0FBSyxJQUFJLEFBQUMsQ0FBQyxTQUFRLENBQUMsQ0FBQztBQUU5QixPQUFHLE1BQU0sRUFBSSxJQUFJLE1BQUksQUFBQyxDQUFFLElBQUcsR0FBSyxDQUFBLElBQUcsTUFBTSxDQUFFLENBQUM7QUFDNUMsT0FBRyxNQUFNLEtBQUssSUFBSSxBQUFDLENBQUMsU0FBUSxDQUFDLENBQUM7QUFFOUIsT0FBRyxJQUFJLEVBQUksQ0FBQSxJQUFHLEdBQUssQ0FBQSxJQUFHLElBQUksQ0FBQztFQUM1QjtBQUFBLEFBRUEsS0FBRyxVQUFVLEVBQUksQ0FBQSxNQUFLLE9BQU8sQUFBQyxDQUFDLEtBQUksVUFBVSxDQUFDLENBQUM7QUFDL0MsS0FBRyxVQUFVLFlBQVksRUFBSSxLQUFHLENBQUM7QUFFakMsS0FBRyxVQUFVLFVBQVUsRUFBSSxVQUFVLENBQUEsQ0FBRyxDQUFBLFNBQVEsQ0FBSTtBQUNuRCxBQUFJLE1BQUEsQ0FBQSxPQUFNLEVBQUksQ0FBQSxJQUFHLE9BQU8sQ0FBRSxDQUFBLENBQUMsQ0FBQztBQUM1QixPQUFHLE9BQU8sQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxRQUFNLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLElBQUcsT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDOUQsT0FBRyxPQUFPLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksUUFBTSxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxJQUFHLE9BQU8sQ0FBRSxDQUFBLENBQUMsQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBRTlELE9BQUssU0FBUSxDQUFJO0FBQ2hCLFlBQU0sRUFBSSxDQUFBLElBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDOUIsU0FBRyxNQUFNLE9BQU8sQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxRQUFNLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLElBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsQ0FBQztBQUMxRSxTQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxFQUFJLFFBQU0sQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsSUFBRyxNQUFNLE9BQU8sQ0FBRSxDQUFBLENBQUMsQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBRTFFLFlBQU0sRUFBSSxDQUFBLElBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDOUIsU0FBRyxNQUFNLE9BQU8sQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxRQUFNLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLElBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsQ0FBQztBQUMxRSxTQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxFQUFJLFFBQU0sQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsSUFBRyxNQUFNLE9BQU8sQ0FBRSxDQUFBLENBQUMsQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxDQUFDO0lBQzNFO0FBQUEsQUFFQSxTQUFPLEtBQUcsQ0FBQztFQUNaLENBQUM7QUFFRCxLQUFHLFVBQVUsT0FBTyxFQUFJLFVBQVUsTUFBSyxDQUFHLENBQUEsUUFBTyxDQUFHLENBQUEsT0FBTSxDQUFHLENBQUEsS0FBSTtBQUNoRSxRQUFVLEdBQUEsQ0FBQSxDQUFBLENBQUEsRUFBSyxDQUFBLElBQUcsSUFBSSxDQUFJO0FBQ3pCLEFBQUksUUFBQSxDQUFBLElBQUcsRUFBSSxDQUFBLElBQUcsSUFBSSxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBRXRCLFNBQUssTUFBTyxLQUFHLENBQUEsR0FBTSxTQUFPLENBQUEsRUFBSyxDQUFBLElBQUcsUUFBUSxDQUFJO0FBQy9DLEFBQUksVUFBQSxDQUFBLElBQUcsRUFBSSxFQUFFLFFBQU8sQ0FBRyxRQUFNLENBQUcsTUFBSSxDQUFFLENBQUM7QUFDdkMsV0FBRyxXQUFXLFFBQVEsQUFBQyxFQUFDLFNBQUEsSUFBRztlQUFLLENBQUEsSUFBRyxLQUFLLEFBQUMsQ0FBRSxNQUFLLENBQUUsSUFBRyxDQUFDLENBQUU7UUFBQSxFQUFFLENBQUM7QUFDM0QsV0FBRyxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsSUFBRyxRQUFRLE1BQU0sQUFBQyxDQUFFLEVBQUMsQ0FBRyxLQUFHLENBQUUsQ0FBQztNQUN6QztBQUFBLEFBRUEsU0FBSyxDQUFBLElBQU0sU0FBTyxDQUFJO0FBQ3JCLEFBQUksVUFBQSxDQUFBLFVBQVMsRUFBSSxDQUFBLElBQUcsSUFBSSxFQUFFLElBQU0sVUFBUSxDQUFBLENBQUksSUFBRSxFQUFJLElBQUU7QUFDbkQsYUFBQyxFQUFJLENBQUEsS0FBSSxDQUFHLElBQUcsSUFBSSxPQUFPLENBQUUsQ0FBQSxDQUFDLFVBQVUsUUFBUSxBQUFDLENBQUMsUUFBTyxDQUFHLEdBQUMsQ0FBQyxDQUFFO0FBQy9ELGFBQUMsRUFBSSxDQUFBLEtBQUksQ0FBRyxJQUFHLElBQUksT0FBTyxDQUFFLENBQUEsQ0FBQyxVQUFVLFFBQVEsQUFBQyxDQUFDLFFBQU8sQ0FBRyxHQUFDLENBQUMsQ0FBRSxDQUFDO0FBRWpFLFdBQUcsT0FBTyxBQUFDLENBQUUsVUFBUyxDQUFHLEdBQUMsQ0FBRyxHQUFDLENBQUUsQ0FBQztNQUNsQztBQUFBLElBQ0Q7QUFBQSxFQUNELENBQUM7QUc3REQsQUFBSSxJQUFBLENBQUEsVUFBUyxFSCtERSxLRy9Ea0IsQUgrRGYsQ0cvRGU7QUNBakM7QUNBQSxnQkFBd0I7QUFBRSx1QkFBd0I7SUFBRTtBQ0FwRCxhQUFTLENBQUcsS0FBRztBQUFBLEdGQVE7QUhFbkIsQ0ZGdUMsQ0FBQztBQytEekIiLCJmaWxlIjoiY2xhc3Nlcy9Ob2RlLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlc0NvbnRlbnQiOlsiZGVmaW5lKCRfX3BsYWNlaG9sZGVyX18wLCAkX19wbGFjZWhvbGRlcl9fMSk7IiwiaW1wb3J0IFBvaW50IGZyb20gJy4vUG9pbnQuanMnO1xuXG5mdW5jdGlvbiBOb2RlKCBhcmdzICkge1xuXHR2YXIgY29vcmRzO1xuXHRpZiAoIGFyZ3MgJiYgKCBhcmdzLnggIT09IHVuZGVmaW5lZCB8fCBhcmdzLnkgIT09IHVuZGVmaW5lZCApICkge1xuXHRcdGNvb3JkcyA9IHtcblx0XHRcdHg6IGFyZ3MueCxcblx0XHRcdHk6IGFyZ3MueVxuXHRcdH07XG5cdH1cblxuXHRQb2ludC5wcm90b3R5cGUuY29uc3RydWN0b3IuYXBwbHkoIHRoaXMsIFsgY29vcmRzIF0gKTtcblxuXHR0aGlzLmxDdHJsID0gbmV3IFBvaW50KCBhcmdzICYmIGFyZ3MubEN0cmwgKTtcblx0dGhpcy5sQ3RybC50YWdzLmFkZCgnY29udHJvbCcpO1xuXG5cdHRoaXMuckN0cmwgPSBuZXcgUG9pbnQoIGFyZ3MgJiYgYXJncy5yQ3RybCApO1xuXHR0aGlzLnJDdHJsLnRhZ3MuYWRkKCdjb250cm9sJyk7XG5cblx0dGhpcy5zcmMgPSBhcmdzICYmIGFyZ3Muc3JjO1xufVxuXG5Ob2RlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUG9pbnQucHJvdG90eXBlKTtcbk5vZGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTm9kZTtcblxuTm9kZS5wcm90b3R5cGUudHJhbnNmb3JtID0gZnVuY3Rpb24oIG0sIHdpdGhDdHJscyApIHtcblx0dmFyIGNvb3JkczAgPSB0aGlzLmNvb3Jkc1swXTtcblx0dGhpcy5jb29yZHNbMF0gPSBtWzBdICogY29vcmRzMCArIG1bMl0gKiB0aGlzLmNvb3Jkc1sxXSArIG1bNF07XG5cdHRoaXMuY29vcmRzWzFdID0gbVsxXSAqIGNvb3JkczAgKyBtWzNdICogdGhpcy5jb29yZHNbMV0gKyBtWzVdO1xuXG5cdGlmICggd2l0aEN0cmxzICkge1xuXHRcdGNvb3JkczAgPSB0aGlzLmxDdHJsLmNvb3Jkc1swXTtcblx0XHR0aGlzLmxDdHJsLmNvb3Jkc1swXSA9IG1bMF0gKiBjb29yZHMwICsgbVsyXSAqIHRoaXMubEN0cmwuY29vcmRzWzFdICsgbVs0XTtcblx0XHR0aGlzLmxDdHJsLmNvb3Jkc1sxXSA9IG1bMV0gKiBjb29yZHMwICsgbVszXSAqIHRoaXMubEN0cmwuY29vcmRzWzFdICsgbVs1XTtcblxuXHRcdGNvb3JkczAgPSB0aGlzLnJDdHJsLmNvb3Jkc1swXTtcblx0XHR0aGlzLnJDdHJsLmNvb3Jkc1swXSA9IG1bMF0gKiBjb29yZHMwICsgbVsyXSAqIHRoaXMuckN0cmwuY29vcmRzWzFdICsgbVs0XTtcblx0XHR0aGlzLnJDdHJsLmNvb3Jkc1sxXSA9IG1bMV0gKiBjb29yZHMwICsgbVszXSAqIHRoaXMuckN0cmwuY29vcmRzWzFdICsgbVs1XTtcblx0fVxuXG5cdHJldHVybiB0aGlzO1xufTtcblxuTm9kZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oIHBhcmFtcywgY29udG91cnMsIGFuY2hvcnMsIG5vZGVzICkge1xuXHRmb3IgKCB2YXIgaSBpbiB0aGlzLnNyYyApIHtcblx0XHR2YXIgYXR0ciA9IHRoaXMuc3JjW2ldO1xuXG5cdFx0aWYgKCB0eXBlb2YgYXR0ciA9PT0gJ29iamVjdCcgJiYgYXR0ci51cGRhdGVyICkge1xuXHRcdFx0dmFyIGFyZ3MgPSBbIGNvbnRvdXJzLCBhbmNob3JzLCBub2RlcyBdO1xuXHRcdFx0YXR0ci5wYXJhbWV0ZXJzLmZvckVhY2gobmFtZSA9PiBhcmdzLnB1c2goIHBhcmFtc1tuYW1lXSApICk7XG5cdFx0XHR0aGlzW2ldID0gYXR0ci51cGRhdGVyLmFwcGx5KCB7fSwgYXJncyApO1xuXHRcdH1cblxuXHRcdGlmICggaSA9PT0gJ29uTGluZScgKSB7XG5cdFx0XHR2YXIga25vd25Db29yZCA9IHRoaXMuc3JjLnggPT09IHVuZGVmaW5lZCA/ICd5JyA6ICd4Jyxcblx0XHRcdFx0cDEgPSBub2Rlc1sgdGhpcy5zcmMub25MaW5lWzBdLm9wZXJhdGlvbi5yZXBsYWNlKC9bXlxcZF0vZywgJycpIF0sXG5cdFx0XHRcdHAyID0gbm9kZXNbIHRoaXMuc3JjLm9uTGluZVsxXS5vcGVyYXRpb24ucmVwbGFjZSgvW15cXGRdL2csICcnKSBdO1xuXG5cdFx0XHR0aGlzLm9uTGluZSgga25vd25Db29yZCwgcDEsIHAyICk7XG5cdFx0fVxuXHR9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBOb2RlOyIsImZ1bmN0aW9uKCRfX3BsYWNlaG9sZGVyX18wKSB7XG4gICAgICAkX19wbGFjZWhvbGRlcl9fMVxuICAgIH0iLCJpZiAoISRfX3BsYWNlaG9sZGVyX18wIHx8ICEkX19wbGFjZWhvbGRlcl9fMS5fX2VzTW9kdWxlKVxuICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzIgPSB7ZGVmYXVsdDogJF9fcGxhY2Vob2xkZXJfXzN9IiwidmFyICRfX2RlZmF1bHQgPSAkX19wbGFjZWhvbGRlcl9fMCIsInJldHVybiAkX19wbGFjZWhvbGRlcl9fMCIsImdldCAkX19wbGFjZWhvbGRlcl9fMCgpIHsgcmV0dXJuICRfX3BsYWNlaG9sZGVyX18xOyB9IiwiX19lc01vZHVsZTogdHJ1ZSJdfQ==
define(['./Point.js'], function($__0) {
  "use strict";
  if (!$__0 || !$__0.__esModule)
    $__0 = {default: $__0};
  var Point = $__0.default;
  function Node(args) {
    var coords;
    if (args.x !== undefined || args.y !== undefined) {
      coords = {
        x: args.x,
        y: args.y
      };
    }
    Point.prototype.constructor.apply(this, [coords]);
    this.lCtrl = new Point(args.lCtrl);
    this.lCtrl.tags.add('control');
    this.rCtrl = new Point(args.rCtrl);
    this.rCtrl.tags.add('control');
    this.src = args.src;
  }
  Node.prototype = Object.create(Point.prototype);
  Node.prototype.constructor = Node;
  Node.prototype.transform = function(m, withCtrls) {
    var coords0 = this.coords[0];
    this.coords[0] = m[0] * coords0 + m[2] * this.coords[1] + m[4];
    this.coords[1] = m[1] * coords0 + m[3] * this.coords[1] + m[5];
    if (withCtrls) {
      coords0 = this.lCtrl.coords[0];
      this.lCtrl.coords[0] = m[0] * coords0 + m[2] * this.lCtrl.coords[1] + m[4];
      this.lCtrl.coords[1] = m[1] * coords0 + m[3] * this.lCtrl.coords[1] + m[5];
      coords0 = this.rCtrl.coords[0];
      this.rCtrl.coords[0] = m[0] * coords0 + m[2] * this.rCtrl.coords[1] + m[4];
      this.rCtrl.coords[1] = m[1] * coords0 + m[3] * this.rCtrl.coords[1] + m[5];
    }
    return this;
  };
  var coords = ['x', 'y'];
  Node.prototype.update = function(params, contours, anchors, nodes) {
    for (var i in this.src) {
      var attr = this.src[i];
      if (typeof attr === 'object' && attr.updater) {
        var args = [contours, anchors, nodes];
        attr.parameters.forEach((function(name) {
          return args.push(params[name]);
        }));
        this[i] = attr.updater.apply({}, args);
      }
      if (i === 'onLine') {
        var knownCoord = this.src.x === undefined ? 'y' : 'x',
            p1 = nodes[this.src.onLine[0].operation.replace(/[^\d]/g, '')],
            p2 = nodes[this.src.onLine[1].operation.replace(/[^\d]/g, '')];
        this.onLine(knownCoord, p1, p2);
      }
    }
  };
  var $__default = Node;
  return {
    get default() {
      return $__default;
    },
    __esModule: true
  };
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci82IiwiY2xhc3Nlcy9Ob2RlLmpzIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzUiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNCIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8wIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMSIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8yIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEtBQUssQUFBQyxFQ0FZLFlBQVcsRUNBN0IsVUFBUyxJQUFnQjs7QUNBekIsS0FBSSxLQUFpQixHQUFLLEVBQUMsZUFBMkI7QUFDMUMsU0FBb0IsRUFBQyxPQUFNLE1BQW1CLENBQUMsQ0FBQTtBQUFBLElGRHBELE1BQUk7QUFFWCxTQUFTLEtBQUcsQ0FBRyxJQUFHLENBQUk7QUFDckIsQUFBSSxNQUFBLENBQUEsTUFBSyxDQUFDO0FBQ1YsT0FBSyxJQUFHLEVBQUUsSUFBTSxVQUFRLENBQUEsRUFBSyxDQUFBLElBQUcsRUFBRSxJQUFNLFVBQVEsQ0FBSTtBQUNuRCxXQUFLLEVBQUk7QUFDUixRQUFBLENBQUcsQ0FBQSxJQUFHLEVBQUU7QUFDUixRQUFBLENBQUcsQ0FBQSxJQUFHLEVBQUU7QUFBQSxNQUNULENBQUM7SUFDRjtBQUFBLEFBRUEsUUFBSSxVQUFVLFlBQVksTUFBTSxBQUFDLENBQUUsSUFBRyxDQUFHLEVBQUUsTUFBSyxDQUFFLENBQUUsQ0FBQztBQUVyRCxPQUFHLE1BQU0sRUFBSSxJQUFJLE1BQUksQUFBQyxDQUFFLElBQUcsTUFBTSxDQUFFLENBQUM7QUFDcEMsT0FBRyxNQUFNLEtBQUssSUFBSSxBQUFDLENBQUMsU0FBUSxDQUFDLENBQUM7QUFFOUIsT0FBRyxNQUFNLEVBQUksSUFBSSxNQUFJLEFBQUMsQ0FBRSxJQUFHLE1BQU0sQ0FBRSxDQUFDO0FBQ3BDLE9BQUcsTUFBTSxLQUFLLElBQUksQUFBQyxDQUFDLFNBQVEsQ0FBQyxDQUFDO0FBRTlCLE9BQUcsSUFBSSxFQUFJLENBQUEsSUFBRyxJQUFJLENBQUM7RUFDcEI7QUFBQSxBQUVBLEtBQUcsVUFBVSxFQUFJLENBQUEsTUFBSyxPQUFPLEFBQUMsQ0FBQyxLQUFJLFVBQVUsQ0FBQyxDQUFDO0FBQy9DLEtBQUcsVUFBVSxZQUFZLEVBQUksS0FBRyxDQUFDO0FBRWpDLEtBQUcsVUFBVSxVQUFVLEVBQUksVUFBVSxDQUFBLENBQUcsQ0FBQSxTQUFRLENBQUk7QUFDbkQsQUFBSSxNQUFBLENBQUEsT0FBTSxFQUFJLENBQUEsSUFBRyxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDNUIsT0FBRyxPQUFPLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksUUFBTSxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxJQUFHLE9BQU8sQ0FBRSxDQUFBLENBQUMsQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBQzlELE9BQUcsT0FBTyxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxFQUFJLFFBQU0sQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsSUFBRyxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsQ0FBQztBQUU5RCxPQUFLLFNBQVEsQ0FBSTtBQUNoQixZQUFNLEVBQUksQ0FBQSxJQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBQzlCLFNBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksUUFBTSxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxJQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDMUUsU0FBRyxNQUFNLE9BQU8sQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxRQUFNLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLElBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsQ0FBQztBQUUxRSxZQUFNLEVBQUksQ0FBQSxJQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBQzlCLFNBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksUUFBTSxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxJQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDMUUsU0FBRyxNQUFNLE9BQU8sQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxRQUFNLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLElBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsQ0FBQztJQUMzRTtBQUFBLEFBRUEsU0FBTyxLQUFHLENBQUM7RUFDWixDQUFBO0FBRUEsQUFBSSxJQUFBLENBQUEsTUFBSyxFQUFJLEVBQUMsR0FBRSxDQUFHLElBQUUsQ0FBQyxDQUFDO0FBQ3ZCLEtBQUcsVUFBVSxPQUFPLEVBQUksVUFBVSxNQUFLLENBQUcsQ0FBQSxRQUFPLENBQUcsQ0FBQSxPQUFNLENBQUcsQ0FBQSxLQUFJO0FBQ2hFLFFBQVUsR0FBQSxDQUFBLENBQUEsQ0FBQSxFQUFLLENBQUEsSUFBRyxJQUFJLENBQUk7QUFDekIsQUFBSSxRQUFBLENBQUEsSUFBRyxFQUFJLENBQUEsSUFBRyxJQUFJLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFFdEIsU0FBSyxNQUFPLEtBQUcsQ0FBQSxHQUFNLFNBQU8sQ0FBQSxFQUFLLENBQUEsSUFBRyxRQUFRLENBQUk7QUFDL0MsQUFBSSxVQUFBLENBQUEsSUFBRyxFQUFJLEVBQUUsUUFBTyxDQUFHLFFBQU0sQ0FBRyxNQUFJLENBQUUsQ0FBQztBQUN2QyxXQUFHLFdBQVcsUUFBUSxBQUFDLEVBQUMsU0FBQSxJQUFHO2VBQUssQ0FBQSxJQUFHLEtBQUssQUFBQyxDQUFFLE1BQUssQ0FBRSxJQUFHLENBQUMsQ0FBRTtRQUFBLEVBQUUsQ0FBQztBQUMzRCxXQUFHLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxJQUFHLFFBQVEsTUFBTSxBQUFDLENBQUUsRUFBQyxDQUFHLEtBQUcsQ0FBRSxDQUFDO01BQ3pDO0FBQUEsQUFFQSxTQUFLLENBQUEsSUFBTSxTQUFPLENBQUk7QUFDckIsQUFBSSxVQUFBLENBQUEsVUFBUyxFQUFJLENBQUEsSUFBRyxJQUFJLEVBQUUsSUFBTSxVQUFRLENBQUEsQ0FBSSxJQUFFLEVBQUksSUFBRTtBQUNuRCxhQUFDLEVBQUksQ0FBQSxLQUFJLENBQUcsSUFBRyxJQUFJLE9BQU8sQ0FBRSxDQUFBLENBQUMsVUFBVSxRQUFRLEFBQUMsQ0FBQyxRQUFPLENBQUcsR0FBQyxDQUFDLENBQUU7QUFDL0QsYUFBQyxFQUFJLENBQUEsS0FBSSxDQUFHLElBQUcsSUFBSSxPQUFPLENBQUUsQ0FBQSxDQUFDLFVBQVUsUUFBUSxBQUFDLENBQUMsUUFBTyxDQUFHLEdBQUMsQ0FBQyxDQUFFLENBQUM7QUFFakUsV0FBRyxPQUFPLEFBQUMsQ0FBRSxVQUFTLENBQUcsR0FBQyxDQUFHLEdBQUMsQ0FBRSxDQUFDO01BQ2xDO0FBQUEsSUFDRDtBQUFBLEVBQ0QsQ0FBQztBRzlERCxBQUFJLElBQUEsQ0FBQSxVQUFTLEVIZ0VFLEtHaEVrQixBSGdFZixDR2hFZTtBQ0FqQztBQ0FBLGdCQUF3QjtBQUFFLHVCQUF3QjtJQUFFO0FDQXBELGFBQVMsQ0FBRyxLQUFHO0FBQUEsR0ZBUTtBSEVuQixDRkZ1QyxDQUFDO0FDZ0V6QiIsImZpbGUiOiJjbGFzc2VzL05vZGUuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzQ29udGVudCI6WyJkZWZpbmUoJF9fcGxhY2Vob2xkZXJfXzAsICRfX3BsYWNlaG9sZGVyX18xKTsiLCJpbXBvcnQgUG9pbnQgZnJvbSAnLi9Qb2ludC5qcyc7XG5cbmZ1bmN0aW9uIE5vZGUoIGFyZ3MgKSB7XG5cdHZhciBjb29yZHM7XG5cdGlmICggYXJncy54ICE9PSB1bmRlZmluZWQgfHwgYXJncy55ICE9PSB1bmRlZmluZWQgKSB7XG5cdFx0Y29vcmRzID0ge1xuXHRcdFx0eDogYXJncy54LFxuXHRcdFx0eTogYXJncy55XG5cdFx0fTtcblx0fVxuXG5cdFBvaW50LnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5hcHBseSggdGhpcywgWyBjb29yZHMgXSApO1xuXG5cdHRoaXMubEN0cmwgPSBuZXcgUG9pbnQoIGFyZ3MubEN0cmwgKTtcblx0dGhpcy5sQ3RybC50YWdzLmFkZCgnY29udHJvbCcpO1xuXG5cdHRoaXMuckN0cmwgPSBuZXcgUG9pbnQoIGFyZ3MuckN0cmwgKTtcblx0dGhpcy5yQ3RybC50YWdzLmFkZCgnY29udHJvbCcpO1xuXG5cdHRoaXMuc3JjID0gYXJncy5zcmM7XG59XG5cbk5vZGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQb2ludC5wcm90b3R5cGUpO1xuTm9kZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBOb2RlO1xuXG5Ob2RlLnByb3RvdHlwZS50cmFuc2Zvcm0gPSBmdW5jdGlvbiggbSwgd2l0aEN0cmxzICkge1xuXHR2YXIgY29vcmRzMCA9IHRoaXMuY29vcmRzWzBdO1xuXHR0aGlzLmNvb3Jkc1swXSA9IG1bMF0gKiBjb29yZHMwICsgbVsyXSAqIHRoaXMuY29vcmRzWzFdICsgbVs0XTtcblx0dGhpcy5jb29yZHNbMV0gPSBtWzFdICogY29vcmRzMCArIG1bM10gKiB0aGlzLmNvb3Jkc1sxXSArIG1bNV07XG5cblx0aWYgKCB3aXRoQ3RybHMgKSB7XG5cdFx0Y29vcmRzMCA9IHRoaXMubEN0cmwuY29vcmRzWzBdO1xuXHRcdHRoaXMubEN0cmwuY29vcmRzWzBdID0gbVswXSAqIGNvb3JkczAgKyBtWzJdICogdGhpcy5sQ3RybC5jb29yZHNbMV0gKyBtWzRdO1xuXHRcdHRoaXMubEN0cmwuY29vcmRzWzFdID0gbVsxXSAqIGNvb3JkczAgKyBtWzNdICogdGhpcy5sQ3RybC5jb29yZHNbMV0gKyBtWzVdO1xuXG5cdFx0Y29vcmRzMCA9IHRoaXMuckN0cmwuY29vcmRzWzBdO1xuXHRcdHRoaXMuckN0cmwuY29vcmRzWzBdID0gbVswXSAqIGNvb3JkczAgKyBtWzJdICogdGhpcy5yQ3RybC5jb29yZHNbMV0gKyBtWzRdO1xuXHRcdHRoaXMuckN0cmwuY29vcmRzWzFdID0gbVsxXSAqIGNvb3JkczAgKyBtWzNdICogdGhpcy5yQ3RybC5jb29yZHNbMV0gKyBtWzVdO1xuXHR9XG5cblx0cmV0dXJuIHRoaXM7XG59XG5cbnZhciBjb29yZHMgPSBbJ3gnLCAneSddO1xuTm9kZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oIHBhcmFtcywgY29udG91cnMsIGFuY2hvcnMsIG5vZGVzICkge1xuXHRmb3IgKCB2YXIgaSBpbiB0aGlzLnNyYyApIHtcblx0XHR2YXIgYXR0ciA9IHRoaXMuc3JjW2ldO1xuXG5cdFx0aWYgKCB0eXBlb2YgYXR0ciA9PT0gJ29iamVjdCcgJiYgYXR0ci51cGRhdGVyICkge1xuXHRcdFx0dmFyIGFyZ3MgPSBbIGNvbnRvdXJzLCBhbmNob3JzLCBub2RlcyBdO1xuXHRcdFx0YXR0ci5wYXJhbWV0ZXJzLmZvckVhY2gobmFtZSA9PiBhcmdzLnB1c2goIHBhcmFtc1tuYW1lXSApICk7XG5cdFx0XHR0aGlzW2ldID0gYXR0ci51cGRhdGVyLmFwcGx5KCB7fSwgYXJncyApO1xuXHRcdH1cblxuXHRcdGlmICggaSA9PT0gJ29uTGluZScgKSB7XG5cdFx0XHR2YXIga25vd25Db29yZCA9IHRoaXMuc3JjLnggPT09IHVuZGVmaW5lZCA/ICd5JyA6ICd4Jyxcblx0XHRcdFx0cDEgPSBub2Rlc1sgdGhpcy5zcmMub25MaW5lWzBdLm9wZXJhdGlvbi5yZXBsYWNlKC9bXlxcZF0vZywgJycpIF0sXG5cdFx0XHRcdHAyID0gbm9kZXNbIHRoaXMuc3JjLm9uTGluZVsxXS5vcGVyYXRpb24ucmVwbGFjZSgvW15cXGRdL2csICcnKSBdO1xuXG5cdFx0XHR0aGlzLm9uTGluZSgga25vd25Db29yZCwgcDEsIHAyICk7XG5cdFx0fVxuXHR9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBOb2RlOyIsImZ1bmN0aW9uKCRfX3BsYWNlaG9sZGVyX18wKSB7XG4gICAgICAkX19wbGFjZWhvbGRlcl9fMVxuICAgIH0iLCJpZiAoISRfX3BsYWNlaG9sZGVyX18wIHx8ICEkX19wbGFjZWhvbGRlcl9fMS5fX2VzTW9kdWxlKVxuICAgICAgICAgICAgJF9fcGxhY2Vob2xkZXJfXzIgPSB7ZGVmYXVsdDogJF9fcGxhY2Vob2xkZXJfXzN9IiwidmFyICRfX2RlZmF1bHQgPSAkX19wbGFjZWhvbGRlcl9fMCIsInJldHVybiAkX19wbGFjZWhvbGRlcl9fMCIsImdldCAkX19wbGFjZWhvbGRlcl9fMCgpIHsgcmV0dXJuICRfX3BsYWNlaG9sZGVyX18xOyB9IiwiX19lc01vZHVsZTogdHJ1ZSJdfQ==
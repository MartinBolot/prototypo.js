define([], function() {
  "use strict";
  var Point = function Point(x, y) {
    if (!(this instanceof $Point)) {
      return new $Point(x, y);
    }
    if (x === undefined || x === null) {
      this.coords = new Float32Array([x, y]);
    } else if (x.constructor === Array || x.constructor === Float32Array) {
      this.coords = new Float32Array(x);
    } else if (typeof x === 'object' && ('x' in x || 'y' in x)) {
      this.coords = new Float32Array([x.x, x.y]);
    } else {
      this.coords = new Float32Array([x, y]);
    }
  };
  var $Point = Point;
  ($traceurRuntime.createClass)(Point, {
    get x() {
      return this.coords[0];
    },
    set x(x) {
      this.coords[0] = x;
    },
    get y() {
      return this.coords[1];
    },
    set y(y) {
      this.coords[1] = y;
    },
    _: function(x, y) {
      if (x === undefined || x === null) {
        this.coords[0] = x;
        this.coords[1] = y;
      } else if (x.constructor === Array || x.constructor === Float32Array) {
        this.coords[0] = x[0];
        this.coords[1] = x[1];
      } else if (typeof x === 'object' && ('x' in x || 'y' in x)) {
        this.coords[0] = x.x;
        this.coords[1] = x.y;
      } else {
        this.coords[0] = x;
        this.coords[1] = y;
      }
      return this;
    },
    translate: function(x, y) {
      var p = x instanceof $Point ? x : new $Point(x, y);
      if (!isNaN(p.coords[0])) {
        this.coords[0] += p.coords[0];
      }
      if (!isNaN(p.coords[1])) {
        this.coords[1] += p.coords[1];
      }
      return this;
    },
    translateX: function(x) {
      this.coords[0] += x;
      return this;
    },
    translateY: function(y) {
      this.coords[1] += y;
      return this;
    },
    transform: function(m, isRecursive) {
      var coords0 = this.coords[0];
      if (m.constructor === Float32Array) {
        this.coords[0] = m[0] * coords0 + m[2] * this.coords[1] + m[4];
        this.coords[1] = m[1] * coords0 + m[3] * this.coords[1] + m[5];
      } else {
        this.coords[0] = m.a * coords0 + m.c * this.coords[1] + m.e;
        this.coords[1] = m.b * coords0 + m.d * this.coords[1] + m.f;
      }
      if (isRecursive && this.children) {
        this.children.forEach((function(child) {
          return child.transform(m, isRecursive);
        }));
      }
      return this;
    },
    toString: function() {
      return (isNaN(this.coords[0]) ? 'NaN' : Math.round(this.coords[0])) + ' ' + (isNaN(this.coords[1]) ? 'NaN' : Math.round(this.coords[1]));
    },
    toJSON: function() {
      return this.toString();
    }
  }, {});
  var $__default = Point;
  return {
    get default() {
      return $__default;
    },
    __esModule: true
  };
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8yIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzEiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNiIsImNsYXNzZXMvUG9pbnQuanMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvOCIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci83IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMCIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci80IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsS0FBSyxBQUFDLElDQU4sVUFBUyxBQUFnQjs7QUNBekIsQUFBSSxJQUFBLFFDQUosU0FBTSxNQUFJLENBRUksQ0FBQSxDQUFHLENBQUEsQ0FBQSxDQUFJO0FBRW5CLE9BQUssQ0FBQyxDQUFFLElBQUcsa0JBQWlCLENBQUUsQ0FBSTtBQUNqQyxXQUFPLFdBQVMsQ0FBRSxDQUFBLENBQUcsRUFBQSxDQUFFLENBQUM7SUFDekI7QUFBQSxBQUVBLE9BQUssQ0FBQSxJQUFNLFVBQVEsQ0FBQSxFQUFLLENBQUEsQ0FBQSxJQUFNLEtBQUcsQ0FBSTtBQUNwQyxTQUFHLE9BQU8sRUFBSSxJQUFJLGFBQVcsQUFBQyxDQUFDLENBQUMsQ0FBQSxDQUFHLEVBQUEsQ0FBQyxDQUFDLENBQUM7SUFFdkMsS0FBTyxLQUFLLENBQUEsWUFBWSxJQUFNLE1BQUksQ0FBQSxFQUFLLENBQUEsQ0FBQSxZQUFZLElBQU0sYUFBVyxDQUFJO0FBQ3ZFLFNBQUcsT0FBTyxFQUFJLElBQUksYUFBVyxBQUFDLENBQUMsQ0FBQSxDQUFDLENBQUM7SUFFbEMsS0FBTyxLQUFLLE1BQU8sRUFBQSxDQUFB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O0lBQUU7QUNBcEQsYUFBUyxDQUFHLEtBQUc7QUFBQSxHRkFRO0FORW5CLENERnVDLENBQUM7QUd1TnhDIiwiZmlsZSI6ImNsYXNzZXMvUG9pbnQuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzQ29udGVudCI6WyJkZWZpbmUoJF9fcGxhY2Vob2xkZXJfXzAsICRfX3BsYWNlaG9sZGVyX18xKTsiLCJmdW5jdGlvbigkX19wbGFjZWhvbGRlcl9fMCkge1xuICAgICAgJF9fcGxhY2Vob2xkZXJfXzFcbiAgICB9IiwidmFyICRfX3BsYWNlaG9sZGVyX18wID0gJF9fcGxhY2Vob2xkZXJfXzEiLCJjbGFzcyBQb2ludCB7XG5cblx0Y29uc3RydWN0b3IoIHgsIHkgKSB7XG5cdFx0Ly8gbmV3IGlzIG9wdGlvbmFsIGluIHRlc3RzXG5cdFx0aWYgKCAhKCB0aGlzIGluc3RhbmNlb2YgUG9pbnQgKSApIHtcblx0XHRcdHJldHVybiBuZXcgUG9pbnQoIHgsIHkgKTtcblx0XHR9XG5cblx0XHRpZiAoIHggPT09IHVuZGVmaW5lZCB8fMKgeCA9PT0gbnVsbCApIHtcblx0XHRcdHRoaXMuY29vcmRzID0gbmV3IEZsb2F0MzJBcnJheShbeCwgeV0pO1xuXG5cdFx0fSBlbHNlIGlmICggeC5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgfHwgeC5jb25zdHJ1Y3RvciA9PT0gRmxvYXQzMkFycmF5ICkge1xuXHRcdFx0dGhpcy5jb29yZHMgPSBuZXcgRmxvYXQzMkFycmF5KHgpO1xuXG5cdFx0fSBlbHNlIGlmICggdHlwZW9mIHggPT09ICdvYmplY3QnICYmICggJ3gnIGluIHggfHwgJ3knIGluIHggKSApIHtcblx0XHRcdHRoaXMuY29vcmRzID0gbmV3IEZsb2F0MzJBcnJheShbeC54LCB4LnldKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvb3JkcyA9IG5ldyBGbG9hdDMyQXJyYXkoW3gsIHldKTtcblxuXHRcdH1cblx0fVxuXG5cdC8vIC54IGFuZCAueSBhcmUgbW9yZSBjb252ZW5pZW50IHRoYW4gLmNvb3Jkc1swXSBhbmQgLmNvb3Jkc1sxXVxuXHRnZXQgeCgpIHtcblx0XHRyZXR1cm4gdGhpcy5jb29yZHNbMF07XG5cdH1cblx0c2V0IHgoIHggKSB7XG5cdFx0dGhpcy5jb29yZHNbMF0gPSB4O1xuXHR9XG5cdGdldCB5KCkge1xuXHRcdHJldHVybiB0aGlzLmNvb3Jkc1sxXTtcblx0fVxuXHRzZXQgeSggeSApIHtcblx0XHR0aGlzLmNvb3Jkc1sxXSA9IHk7XG5cdH1cblxuXHQvLyBhIHNldHRlciBmb3IgeC95IGNvb3JkaW5hdGVzIHRoYXQgYmVoYXZlcyBleGFjdGx5IGxpa2UgdGhlIGNvbnN0cnVjdG9yXG5cdF8oeCwgeSkge1xuXHRcdGlmICggeCA9PT0gdW5kZWZpbmVkIHx8wqB4ID09PSBudWxsICkge1xuXHRcdFx0dGhpcy5jb29yZHNbMF0gPSB4O1xuXHRcdFx0dGhpcy5jb29yZHNbMV0gPSB5O1xuXG5cdFx0fSBlbHNlIGlmICggeC5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgfHwgeC5jb25zdHJ1Y3RvciA9PT0gRmxvYXQzMkFycmF5ICkge1xuXHRcdFx0dGhpcy5jb29yZHNbMF0gPSB4WzBdO1xuXHRcdFx0dGhpcy5jb29yZHNbMV0gPSB4WzFdO1xuXG5cdFx0fSBlbHNlIGlmICggdHlwZW9mIHggPT09ICdvYmplY3QnICYmICggJ3gnIGluIHggfHwgJ3knIGluIHggKSApIHtcblx0XHRcdHRoaXMuY29vcmRzWzBdID0geC54O1xuXHRcdFx0dGhpcy5jb29yZHNbMV0gPSB4Lnk7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jb29yZHNbMF0gPSB4O1xuXHRcdFx0dGhpcy5jb29yZHNbMV0gPSB5O1xuXG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHR0cmFuc2xhdGUoIHgsIHkgKSB7XG5cdFx0dmFyIHAgPSB4IGluc3RhbmNlb2YgUG9pbnQgP1xuXHRcdFx0XHR4OlxuXHRcdFx0XHRuZXcgUG9pbnQoIHgsIHkgKTtcblxuXHRcdGlmICggIWlzTmFOKCBwLmNvb3Jkc1swXSApICkge1xuXHRcdFx0dGhpcy5jb29yZHNbMF0gKz0gcC5jb29yZHNbMF07XG5cdFx0fVxuXHRcdGlmICggIWlzTmFOKCBwLmNvb3Jkc1sxXSApICkge1xuXHRcdFx0dGhpcy5jb29yZHNbMV0gKz0gcC5jb29yZHNbMV07XG5cdFx0fVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHR0cmFuc2xhdGVYKCB4ICkge1xuXHRcdHRoaXMuY29vcmRzWzBdICs9IHg7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHR0cmFuc2xhdGVZKCB5ICkge1xuXHRcdHRoaXMuY29vcmRzWzFdICs9IHk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH1cblxuXHR0cmFuc2Zvcm0oIG0sIGlzUmVjdXJzaXZlICkge1xuXHRcdHZhciBjb29yZHMwID0gdGhpcy5jb29yZHNbMF07XG5cblx0XHRpZiAoIG0uY29uc3RydWN0b3IgPT09IEZsb2F0MzJBcnJheSApIHtcblx0XHRcdHRoaXMuY29vcmRzWzBdID0gbVswXSAqIGNvb3JkczAgKyBtWzJdICogdGhpcy5jb29yZHNbMV0gKyBtWzRdO1xuXHRcdFx0dGhpcy5jb29yZHNbMV0gPSBtWzFdICogY29vcmRzMCArIG1bM10gKiB0aGlzLmNvb3Jkc1sxXSArIG1bNV07XG5cblx0XHQvLyBhLmNvbnN0cnVjdG9yID09PSBTVkdNYXRyaXhcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jb29yZHNbMF0gPSBtLmEgKiBjb29yZHMwICsgbS5jICogdGhpcy5jb29yZHNbMV0gKyBtLmU7XG5cdFx0XHR0aGlzLmNvb3Jkc1sxXSA9IG0uYiAqIGNvb3JkczAgKyBtLmQgKiB0aGlzLmNvb3Jkc1sxXSArIG0uZjtcblx0XHR9XG5cblx0XHRpZiAoIGlzUmVjdXJzaXZlICYmIHRoaXMuY2hpbGRyZW4gKSB7XG5cdFx0XHR0aGlzLmNoaWxkcmVuLmZvckVhY2goIGNoaWxkID0+IGNoaWxkLnRyYW5zZm9ybSggbSwgaXNSZWN1cnNpdmUgKSApO1xuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9XG5cblx0dG9TdHJpbmcoKSB7XG5cdFx0cmV0dXJuICggaXNOYU4oIHRoaXMuY29vcmRzWzBdICkgPyAnTmFOJyA6IE1hdGgucm91bmQoIHRoaXMuY29vcmRzWzBdICkgKSArXG5cdFx0XHQnICcgK1xuXHRcdFx0KCBpc05hTiggdGhpcy5jb29yZHNbMV0gKSA/ICdOYU4nIDogTWF0aC5yb3VuZCggdGhpcy5jb29yZHNbMV0gKSApO1xuXHR9XG5cblx0dG9KU09OKCkge1xuXHRcdHJldHVybiB0aGlzLnRvU3RyaW5nKCk7XG5cdH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgUG9pbnQ7XG5cblx0Ly8gXHRyZXR1cm4gUG9pbnQ7XG5cdC8vIH0pO1xuXG5cdC8vIHNvbWUgZnVuY3Rpb25zIG5lZWQgdG8gYmUgYWRkZWQgdG8gdGhlIHByb3RvdHlwZSBhdCBydW50aW1lIHRvIGF2b2lkIGNpcmN1bGFyIGRlcGVuZGVuY3lcblx0LyoucnVuKGZ1bmN0aW9uKFBvaW50LCBwb2ludE9uKSB7XG5cdFx0UG9pbnQucHJvdG90eXBlLm9uID0gcG9pbnRPbjtcblx0fSlcblxuXHQuZmFjdG9yeSgncG9pbnRPbicsIGZ1bmN0aW9uKCBQb2ludCwgbGluZUxpbmVJbnRlcnNlY3Rpb24gKSB7XG5cdFx0Ly8gdGhpcyByZWdleHAgaXMgZHVwbGljYXRlZCBpbiBTZWdtZW50LmpzXG5cdFx0dmFyIHJzdHJhaWdodCA9IC9bTFZNSF0vO1xuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCBhcmdzICkge1xuXHRcdFx0dmFyIG9yaWdpbixcblx0XHRcdFx0dmVjdG9yO1xuXG5cdFx0XHQvLyBoYW5kbGUgY2FzZXMgd2hlcmUgYXJncyByZWZlcnMgdG8gdW5kZWZpbmVkIGRhdGFcblx0XHRcdGlmICggYXJncyA9PT0gdW5kZWZpbmVkIHx8ICggYXJncy5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgJiYgKCBhcmdzWzBdID09PSB1bmRlZmluZWQgfHwgYXJnc1sxXSA9PT0gdW5kZWZpbmVkICkgKSApIHtcblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9XG5cblx0XHRcdC8vIHBvaW50IG9uIGEgc2VnbWVudFxuXHRcdFx0aWYgKCAhaXNOYU4oIHRoaXMuY29vcmRzWzBdICkgfHwgIWlzTmFOKCB0aGlzLmNvb3Jkc1sxXSApICkge1xuXG5cdFx0XHRcdC8vIHBvaW50IG9uIGEgc3RyYWlnaHQgbGluZVxuXHRcdFx0XHRpZiAoICggYXJncy5jb21tYW5kICE9PSB1bmRlZmluZWQgJiYgcnN0cmFpZ2h0LnRlc3QoYXJncy5jb21tYW5kKSApIHx8XG5cdFx0XHRcdFx0YXJncy5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgKSB7XG5cdFx0XHRcdFx0Ly8gc2VnbWVudCBmcm9tIHR3byBwb2ludHNcblx0XHRcdFx0XHRpZiAoIGFyZ3MuY29uc3RydWN0b3IgPT09IEFycmF5ICkge1xuXHRcdFx0XHRcdFx0b3JpZ2luID0gYXJnc1swXTtcblx0XHRcdFx0XHRcdHZlY3RvciA9IFtcblx0XHRcdFx0XHRcdFx0YXJnc1sxXS54IC0gYXJnc1swXS54LFxuXHRcdFx0XHRcdFx0XHRhcmdzWzFdLnkgLSBhcmdzWzBdLnlcblx0XHRcdFx0XHRcdF07XG5cblx0XHRcdFx0XHQvLyBTZWdtZW50IGluc3RhbmNlXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdG9yaWdpbiA9IGFyZ3Muc3RhcnQ7XG5cdFx0XHRcdFx0XHR2ZWN0b3IgPSBbXG5cdFx0XHRcdFx0XHRcdGFyZ3MuZW5kLnggLSBhcmdzLnN0YXJ0LngsXG5cdFx0XHRcdFx0XHRcdGFyZ3MuZW5kLnkgLSBhcmdzLnN0YXJ0Lnlcblx0XHRcdFx0XHRcdF07XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKCB0aGlzLmNvb3Jkc1swXSApIHtcblx0XHRcdFx0XHRcdHRoaXMuY29vcmRzWzFdID0gKCB0aGlzLmNvb3Jkc1swXSAtIG9yaWdpbi54ICkgLyB2ZWN0b3JbMF0gKiB2ZWN0b3JbMV0gKyBvcmlnaW4ueTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dGhpcy5jb29yZHNbMF0gPSAoIHRoaXMuY29vcmRzWzFdIC0gb3JpZ2luLnkgKSAvIHZlY3RvclsxXSAqIHZlY3RvclswXSArIG9yaWdpbi54O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdHJldHVybiB0aGlzO1xuXG5cdFx0XHRcdC8vIHBvaW50IG9uIGEgY3VydmVcblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHR9XG5cblx0XHRcdC8vIGludGVyc2VjdGlvblxuXHRcdFx0fSBlbHNlIGlmICggYXJncy5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgJiYgYXJncy5sZW5ndGggPT09IDIgKSB7XG5cblx0XHRcdFx0Ly8gbGluZS1saW5lIGludGVyc2VjdGlvblxuXHRcdFx0XHRpZiAoXHQoIGFyZ3NbMF0uY29uc3RydWN0b3IgPT09IEFycmF5IHx8IHJzdHJhaWdodC50ZXN0KGFyZ3NbMF0uY29tbWFuZCkgKSAmJlxuXHRcdFx0XHRcdFx0KCBhcmdzWzFdLmNvbnN0cnVjdG9yID09PSBBcnJheSB8fCByc3RyYWlnaHQudGVzdChhcmdzWzFdLmNvbW1hbmQpICkgKSB7XG5cblx0XHRcdFx0XHR2YXIgcDEgPSBhcmdzWzBdLmNvbnN0cnVjdG9yID09PSBBcnJheSA/XG5cdFx0XHRcdFx0XHRcdCggYXJnc1swXVswXSBpbnN0YW5jZW9mIFBvaW50ID9cblx0XHRcdFx0XHRcdFx0XHRhcmdzWzBdWzBdOlxuXHRcdFx0XHRcdFx0XHRcdG5ldyBQb2ludCggYXJnc1swXVswXSApICk6XG5cdFx0XHRcdFx0XHRcdGFyZ3NbMF0uc3RhcnQsXG5cdFx0XHRcdFx0XHRwMiA9IGFyZ3NbMF0uY29uc3RydWN0b3IgPT09IEFycmF5ID9cblx0XHRcdFx0XHRcdFx0KCBhcmdzWzBdWzFdIGluc3RhbmNlb2YgUG9pbnQgP1xuXHRcdFx0XHRcdFx0XHRcdGFyZ3NbMF1bMV06XG5cdFx0XHRcdFx0XHRcdFx0bmV3IFBvaW50KCBhcmdzWzBdWzFdICkgKTpcblx0XHRcdFx0XHRcdFx0YXJnc1swXS5lbmQsXG5cdFx0XHRcdFx0XHRwMyA9IGFyZ3NbMV0uY29uc3RydWN0b3IgPT09IEFycmF5ID9cblx0XHRcdFx0XHRcdFx0KCBhcmdzWzFdWzBdIGluc3RhbmNlb2YgUG9pbnQgP1xuXHRcdFx0XHRcdFx0XHRcdGFyZ3NbMV1bMF06XG5cdFx0XHRcdFx0XHRcdFx0bmV3IFBvaW50KCBhcmdzWzFdWzBdICkgKTpcblx0XHRcdFx0XHRcdFx0YXJnc1sxXS5zdGFydCxcblx0XHRcdFx0XHRcdHA0ID0gYXJnc1sxXS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgP1xuXHRcdFx0XHRcdFx0XHQoIGFyZ3NbMV1bMV0gaW5zdGFuY2VvZiBQb2ludCA/XG5cdFx0XHRcdFx0XHRcdFx0YXJnc1sxXVsxXTpcblx0XHRcdFx0XHRcdFx0XHRuZXcgUG9pbnQoIGFyZ3NbMV1bMV0gKSApOlxuXHRcdFx0XHRcdFx0XHRhcmdzWzFdLmVuZDtcblxuXHRcdFx0XHRcdHJldHVybiB0aGlzLl8oIGxpbmVMaW5lSW50ZXJzZWN0aW9uKCBwMSwgcDIsIHAzLCBwNCApICk7XG5cblx0XHRcdFx0Ly8gY3VydmUtY3VydmUgaW50ZXJzZWN0aW9uXG5cdFx0XHRcdH0gZWxzZSBpZiAoIGFyZ3NbMF0uY29tbWFuZCA9PT0gJ0MnICYmIGFyZ3NbMV0uY29tbWFuZCA9PT0gJ0MnICkge1xuXG5cdFx0XHRcdC8vIGxpbmUtY3VydmUgb3IgY3VydmUtbGluZSBpbnRlcnNlY3Rpb25cblx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHR9XG5cblx0XHRcdH1cblx0XHR9O1xuXHR9KSovIiwidmFyICRfX3BsYWNlaG9sZGVyX18wID0gJF9fcGxhY2Vob2xkZXJfXzEiLCIoJHRyYWNldXJSdW50aW1lLmNyZWF0ZUNsYXNzKSgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEsICRfX3BsYWNlaG9sZGVyX18yKSIsInZhciAkX19kZWZhdWx0ID0gJF9fcGxhY2Vob2xkZXJfXzAiLCJyZXR1cm4gJF9fcGxhY2Vob2xkZXJfXzAiLCJnZXQgJF9fcGxhY2Vob2xkZXJfXzAoKSB7IHJldHVybiAkX19wbGFjZWhvbGRlcl9fMTsgfSIsIl9fZXNNb2R1bGU6IHRydWUiXX0=
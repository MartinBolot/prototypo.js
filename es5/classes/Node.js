define(['./Point.js'], function($__0) {
  "use strict";
  if (!$__0 || !$__0.__esModule)
    $__0 = {default: $__0};
  var Point = $__0.default;
  function Node(args) {
    var coords;
    if (args.x !== undefined || args.y !== undefined) {
      coords = {
        x: args.x,
        y: args.y
      };
    }
    Point.prototype.constructor.apply(this, [coords]);
    this.lCtrl = new Point(args.lCtrl);
    this.lCtrl.tags.add('control');
    this.rCtrl = new Point(args.rCtrl);
    this.rCtrl.tags.add('control');
    this.src = args.src;
  }
  Node.prototype = Object.create(Point.prototype);
  Node.prototype.constructor = Node;
  Node.prototype.transform = function(m, withCtrls) {
    var coords0 = this.coords[0];
    this.coords[0] = m[0] * coords0 + m[2] * this.coords[1] + m[4];
    this.coords[1] = m[1] * coords0 + m[3] * this.coords[1] + m[5];
    if (withCtrls) {
      coords0 = this.lCtrl.coords[0];
      this.lCtrl.coords[0] = m[0] * coords0 + m[2] * this.lCtrl.coords[1] + m[4];
      this.lCtrl.coords[1] = m[1] * coords0 + m[3] * this.lCtrl.coords[1] + m[5];
      coords0 = this.rCtrl.coords[0];
      this.rCtrl.coords[0] = m[0] * coords0 + m[2] * this.rCtrl.coords[1] + m[4];
      this.rCtrl.coords[1] = m[1] * coords0 + m[3] * this.rCtrl.coords[1] + m[5];
    }
    return this;
  };
  Node.prototype.update = function(params, contours, anchors, nodes) {
    for (var i in this.src) {
      var attr = this.src[i];
      if (typeof attr === 'object' && attr.updater) {
        var args = [contours, anchors, nodes];
        attr.parameters.forEach((function(name) {
          return args.push(params[name]);
        }));
        this[i] = attr.updater.apply({}, args);
      }
      if (i === 'onLine') {
        var knownCoord = this.src.x === undefined ? 'y' : 'x',
            p1 = nodes[this.src.onLine[0].operation.replace(/[^\d]/g, '')],
            p2 = nodes[this.src.onLine[1].operation.replace(/[^\d]/g, '')];
        this.onLine(knownCoord, p1, p2);
      }
    }
  };
  var $__default = Node;
  return {
    get default() {
      return $__default;
    },
    __esModule: true
  };
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci82IiwiY2xhc3Nlcy9Ob2RlLmpzIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzUiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvNCIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8wIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzMiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMSIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8yIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEtBQUssQUFBQyxFQ0FZLFlBQVcsRUNBN0IsVUFBUyxJQUFnQjs7QUNBekIsS0FBSSxLQUFpQixHQUFLLEVBQUMsZUFBMkI7QUFDMUMsU0FBb0IsRUFBQyxPQUFNLE1BQW1CLENBQUMsQ0FBQTtBQUFBLElGRHBELE1BQUk7QUFFWCxTQUFTLEtBQUcsQ0FBRyxJQUFHLENBQUk7QUFDckIsQUFBSSxNQUFBLENBQUEsTUFBSyxDQUFDO0FBQ1YsT0FBSyxJQUFHLEVBQUUsSUFBTSxVQUFRLENBQUEsRUFBSyxDQUFBLElBQUcsRUFBRSxJQUFNLFVBQVEsQ0FBSTtBQUNuRCxXQUFLLEVBQUk7QUFDUixRQUFBLENBQUcsQ0FBQSxJQUFHLEVBQUU7QUFDUixRQUFBLENBQUcsQ0FBQSxJQUFHLEVBQUU7QUFBQSxNQUNULENBQUM7SUFDRjtBQUFBLEFBRUEsUUFBSSxVQUFVLFlBQVksTUFBTSxBQUFDLENBQUUsSUFBRyxDQUFHLEVBQUUsTUFBSyxDQUFFLENBQUUsQ0FBQztBQUVyRCxPQUFHLE1BQU0sRUFBSSxJQUFJLE1BQUksQUFBQyxDQUFFLElBQUcsTUFBTSxDQUFFLENBQUM7QUFDcEMsT0FBRyxNQUFNLEtBQUssSUFBSSxBQUFDLENBQUMsU0FBUSxDQUFDLENBQUM7QUFFOUIsT0FBRyxNQUFNLEVBQUksSUFBSSxNQUFJLEFBQUMsQ0FBRSxJQUFHLE1BQU0sQ0FBRSxDQUFDO0FBQ3BDLE9BQUcsTUFBTSxLQUFLLElBQUksQUFBQyxDQUFDLFNBQVEsQ0FBQyxDQUFDO0FBRTlCLE9BQUcsSUFBSSxFQUFJLENBQUEsSUFBRyxJQUFJLENBQUM7RUFDcEI7QUFBQSxBQUVBLEtBQUcsVUFBVSxFQUFJLENBQUEsTUFBSyxPQUFPLEFBQUMsQ0FBQyxLQUFJLFVBQVUsQ0FBQyxDQUFDO0FBQy9DLEtBQUcsVUFBVSxZQUFZLEVBQUksS0FBRyxDQUFDO0FBRWpDLEtBQUcsVUFBVSxVQUFVLEVBQUksVUFBVSxDQUFBLENBQUcsQ0FBQSxTQUFRLENBQUk7QUFDbkQsQUFBSSxNQUFBLENBQUEsT0FBTSxFQUFJLENBQUEsSUFBRyxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDNUIsT0FBRyxPQUFPLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksUUFBTSxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxJQUFHLE9BQU8sQ0FBRSxDQUFBLENBQUMsQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBQzlELE9BQUcsT0FBTyxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxFQUFJLFFBQU0sQ0FBQSxDQUFJLENBQUEsQ0FBQSxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsSUFBRyxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsQ0FBQztBQUU5RCxPQUFLLFNBQVEsQ0FBSTtBQUNoQixZQUFNLEVBQUksQ0FBQSxJQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBQzlCLFNBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksUUFBTSxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxJQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDMUUsU0FBRyxNQUFNLE9BQU8sQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxRQUFNLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLElBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsQ0FBQztBQUUxRSxZQUFNLEVBQUksQ0FBQSxJQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFDO0FBQzlCLFNBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksUUFBTSxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxJQUFHLE1BQU0sT0FBTyxDQUFFLENBQUEsQ0FBQyxDQUFBLENBQUksQ0FBQSxDQUFBLENBQUUsQ0FBQSxDQUFDLENBQUM7QUFDMUUsU0FBRyxNQUFNLE9BQU8sQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxRQUFNLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLElBQUcsTUFBTSxPQUFPLENBQUUsQ0FBQSxDQUFDLENBQUEsQ0FBSSxDQUFBLENBQUEsQ0FBRSxDQUFBLENBQUMsQ0FBQztJQUMzRTtBQUFBLEFBRUEsU0FBTyxLQUFHLENBQUM7RUFDWixDQUFDO0FBRUQsS0FBRyxVQUFVLE9BQU8sRUFBSSxVQUFVLE1BQUssQ0FBRyxDQUFBLFFBQU8sQ0FBRyxDQUFBLE9BQU0sQ0FBRyxDQUFBLEtBQUk7QUFDaEUsUUFBVSxHQUFBLENBQUEsQ0FBQSxDQUFBLEVBQUssQ0FBQSxJQUFHLElBQUksQ0FBSTtBQUN6QixBQUFJLFFBQUEsQ0FBQSxJQUFHLEVBQUksQ0FBQSxJQUFHLElBQUksQ0FBRSxDQUFBLENBQUMsQ0FBQztBQUV0QixTQUFLLE1BQU8sS0FBRyxDQUFBLEdBQU0sU0FBTyxDQUFBLEVBQUssQ0FBQSxJQUFHLFFBQVEsQ0FBSTtBQUMvQyxBQUFJLFVBQUEsQ0FBQSxJQUFHLEVBQUksRUFBRSxRQUFPLENBQUcsUUFBTSxDQUFHLE1BQUksQ0FBRSxDQUFDO0FBQ3ZDLFdBQUcsV0FBVyxRQUFRLEFBQUMsRUFBQyxTQUFBLElBQUc7ZUFBSyxDQUFBLElBQUcsS0FBSyxBQUFDLENBQUUsTUFBSyxDQUFFLElBQUcsQ0FBQyxDQUFFO1FBQUEsRUFBRSxDQUFDO0FBQzNELFdBQUcsQ0FBRSxDQUFBLENBQUMsRUFBSSxDQUFBLElBQUcsUUFBUSxNQUFNLEFBQUMsQ0FBRSxFQUFDLENBQUcsS0FBRyxDQUFFLENBQUM7TUFDekM7QUFBQSxBQUVBLFNBQUssQ0FBQSxJQUFNLFNBQU8sQ0FBSTtBQUNyQixBQUFJLFVBQUEsQ0FBQSxVQUFTLEVBQUksQ0FBQSxJQUFHLElBQUksRUFBRSxJQUFNLFVBQVEsQ0FBQSxDQUFJLElBQUUsRUFBSSxJQUFFO0FBQ25ELGFBQUMsRUFBSSxDQUFBLEtBQUksQ0FBRyxJQUFHLElBQUksT0FBTyxDQUFFLENBQUEsQ0FBQyxVQUFVLFFBQVEsQUFBQyxDQUFDLFFBQU8sQ0FBRyxHQUFDLENBQUMsQ0FBRTtBQUMvRCxhQUFDLEVBQUksQ0FBQSxLQUFJLENBQUcsSUFBRyxJQUFJLE9BQU8sQ0FBRSxDQUFBLENBQUMsVUFBVSxRQUFRLEFBQUMsQ0FBQyxRQUFPLENBQUcsR0FBQyxDQUFDLENBQUUsQ0FBQztBQUVqRSxXQUFHLE9BQU8sQUFBQyxDQUFFLFVBQVMsQ0FBRyxHQUFDLENBQUcsR0FBQyxDQUFFLENBQUM7TUFDbEM7QUFBQSxJQUNEO0FBQUEsRUFDRCxDQUFDO0FHN0RELEFBQUksSUFBQSxDQUFBLFVBQVMsRUgrREUsS0cvRGtCLEFIK0RmLENHL0RlO0FDQWpDO0FDQUEsZ0JBQXdCO0FBQUUsdUJBQXdCO0lBQUU7QUNBcEQsYUFBUyxDQUFHLEtBQUc7QUFBQSxHRkFRO0FIRW5CLENGRnVDLENBQUM7QUMrRHpCIiwiZmlsZSI6ImNsYXNzZXMvTm9kZS5qcyIsInNvdXJjZVJvb3QiOiIuLiIsInNvdXJjZXNDb250ZW50IjpbImRlZmluZSgkX19wbGFjZWhvbGRlcl9fMCwgJF9fcGxhY2Vob2xkZXJfXzEpOyIsImltcG9ydCBQb2ludCBmcm9tICcuL1BvaW50LmpzJztcblxuZnVuY3Rpb24gTm9kZSggYXJncyApIHtcblx0dmFyIGNvb3Jkcztcblx0aWYgKCBhcmdzLnggIT09IHVuZGVmaW5lZCB8fCBhcmdzLnkgIT09IHVuZGVmaW5lZCApIHtcblx0XHRjb29yZHMgPSB7XG5cdFx0XHR4OiBhcmdzLngsXG5cdFx0XHR5OiBhcmdzLnlcblx0XHR9O1xuXHR9XG5cblx0UG9pbnQucHJvdG90eXBlLmNvbnN0cnVjdG9yLmFwcGx5KCB0aGlzLCBbIGNvb3JkcyBdICk7XG5cblx0dGhpcy5sQ3RybCA9IG5ldyBQb2ludCggYXJncy5sQ3RybCApO1xuXHR0aGlzLmxDdHJsLnRhZ3MuYWRkKCdjb250cm9sJyk7XG5cblx0dGhpcy5yQ3RybCA9IG5ldyBQb2ludCggYXJncy5yQ3RybCApO1xuXHR0aGlzLnJDdHJsLnRhZ3MuYWRkKCdjb250cm9sJyk7XG5cblx0dGhpcy5zcmMgPSBhcmdzLnNyYztcbn1cblxuTm9kZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBvaW50LnByb3RvdHlwZSk7XG5Ob2RlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE5vZGU7XG5cbk5vZGUucHJvdG90eXBlLnRyYW5zZm9ybSA9IGZ1bmN0aW9uKCBtLCB3aXRoQ3RybHMgKSB7XG5cdHZhciBjb29yZHMwID0gdGhpcy5jb29yZHNbMF07XG5cdHRoaXMuY29vcmRzWzBdID0gbVswXSAqIGNvb3JkczAgKyBtWzJdICogdGhpcy5jb29yZHNbMV0gKyBtWzRdO1xuXHR0aGlzLmNvb3Jkc1sxXSA9IG1bMV0gKiBjb29yZHMwICsgbVszXSAqIHRoaXMuY29vcmRzWzFdICsgbVs1XTtcblxuXHRpZiAoIHdpdGhDdHJscyApIHtcblx0XHRjb29yZHMwID0gdGhpcy5sQ3RybC5jb29yZHNbMF07XG5cdFx0dGhpcy5sQ3RybC5jb29yZHNbMF0gPSBtWzBdICogY29vcmRzMCArIG1bMl0gKiB0aGlzLmxDdHJsLmNvb3Jkc1sxXSArIG1bNF07XG5cdFx0dGhpcy5sQ3RybC5jb29yZHNbMV0gPSBtWzFdICogY29vcmRzMCArIG1bM10gKiB0aGlzLmxDdHJsLmNvb3Jkc1sxXSArIG1bNV07XG5cblx0XHRjb29yZHMwID0gdGhpcy5yQ3RybC5jb29yZHNbMF07XG5cdFx0dGhpcy5yQ3RybC5jb29yZHNbMF0gPSBtWzBdICogY29vcmRzMCArIG1bMl0gKiB0aGlzLnJDdHJsLmNvb3Jkc1sxXSArIG1bNF07XG5cdFx0dGhpcy5yQ3RybC5jb29yZHNbMV0gPSBtWzFdICogY29vcmRzMCArIG1bM10gKiB0aGlzLnJDdHJsLmNvb3Jkc1sxXSArIG1bNV07XG5cdH1cblxuXHRyZXR1cm4gdGhpcztcbn07XG5cbk5vZGUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCBwYXJhbXMsIGNvbnRvdXJzLCBhbmNob3JzLCBub2RlcyApIHtcblx0Zm9yICggdmFyIGkgaW4gdGhpcy5zcmMgKSB7XG5cdFx0dmFyIGF0dHIgPSB0aGlzLnNyY1tpXTtcblxuXHRcdGlmICggdHlwZW9mIGF0dHIgPT09ICdvYmplY3QnICYmIGF0dHIudXBkYXRlciApIHtcblx0XHRcdHZhciBhcmdzID0gWyBjb250b3VycywgYW5jaG9ycywgbm9kZXMgXTtcblx0XHRcdGF0dHIucGFyYW1ldGVycy5mb3JFYWNoKG5hbWUgPT4gYXJncy5wdXNoKCBwYXJhbXNbbmFtZV0gKSApO1xuXHRcdFx0dGhpc1tpXSA9IGF0dHIudXBkYXRlci5hcHBseSgge30sIGFyZ3MgKTtcblx0XHR9XG5cblx0XHRpZiAoIGkgPT09ICdvbkxpbmUnICkge1xuXHRcdFx0dmFyIGtub3duQ29vcmQgPSB0aGlzLnNyYy54ID09PSB1bmRlZmluZWQgPyAneScgOiAneCcsXG5cdFx0XHRcdHAxID0gbm9kZXNbIHRoaXMuc3JjLm9uTGluZVswXS5vcGVyYXRpb24ucmVwbGFjZSgvW15cXGRdL2csICcnKSBdLFxuXHRcdFx0XHRwMiA9IG5vZGVzWyB0aGlzLnNyYy5vbkxpbmVbMV0ub3BlcmF0aW9uLnJlcGxhY2UoL1teXFxkXS9nLCAnJykgXTtcblxuXHRcdFx0dGhpcy5vbkxpbmUoIGtub3duQ29vcmQsIHAxLCBwMiApO1xuXHRcdH1cblx0fVxufTtcblxuZXhwb3J0IGRlZmF1bHQgTm9kZTsiLCJmdW5jdGlvbigkX19wbGFjZWhvbGRlcl9fMCkge1xuICAgICAgJF9fcGxhY2Vob2xkZXJfXzFcbiAgICB9IiwiaWYgKCEkX19wbGFjZWhvbGRlcl9fMCB8fCAhJF9fcGxhY2Vob2xkZXJfXzEuX19lc01vZHVsZSlcbiAgICAgICAgICAgICRfX3BsYWNlaG9sZGVyX18yID0ge2RlZmF1bHQ6ICRfX3BsYWNlaG9sZGVyX18zfSIsInZhciAkX19kZWZhdWx0ID0gJF9fcGxhY2Vob2xkZXJfXzAiLCJyZXR1cm4gJF9fcGxhY2Vob2xkZXJfXzAiLCJnZXQgJF9fcGxhY2Vob2xkZXJfXzAoKSB7IHJldHVybiAkX19wbGFjZWhvbGRlcl9fMTsgfSIsIl9fZXNNb2R1bGU6IHRydWUiXX0=
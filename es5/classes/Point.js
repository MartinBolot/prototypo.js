define(['./Classify.js'], function($__0) {
  "use strict";
  if (!$__0 || !$__0.__esModule)
    $__0 = {default: $__0};
  var Classify = $__0.default;
  function Point(x, y) {
    Classify.prototype.constructor.call(this);
    if (!x && x !== 0) {
      this.coords = new Float32Array([x, y]);
    } else if (x.constructor === Array || x.constructor === Float32Array) {
      this.coords = new Float32Array(x);
    } else if (typeof x === 'object' && ('x' in x || 'y' in x)) {
      this.coords = new Float32Array([x.x, x.y]);
    } else {
      this.coords = new Float32Array([x, y]);
    }
  }
  Point.prototype = Object.create(Classify.prototype);
  Point.prototype.constructor = Point;
  Object.mixin(Point.prototype, {
    get x() {
      return this.coords[0];
    },
    set x(x) {
      this.coords[0] = x;
    },
    get y() {
      return this.coords[1];
    },
    set y(y) {
      this.coords[1] = y;
    },
    set: function(x, y) {
      this.coords[0] = x;
      this.coords[1] = y;
    },
    transform: function(m) {
      var coords0 = this.coords[0];
      this.coords[0] = m[0] * coords0 + m[2] * this.coords[1] + m[4];
      this.coords[1] = m[1] * coords0 + m[3] * this.coords[1] + m[5];
      return this;
    },
    toString: function() {
      return (isNaN(this.coords[0]) ? 'NaN' : Math.round(this.coords[0])) + ' ' + (isNaN(this.coords[1]) ? 'NaN' : Math.round(this.coords[1]));
    },
    toJSON: function() {
      return this.toString();
    },
    _: function(x, y) {
      if (x === undefined || x === null) {
        this.coords[0] = x;
        this.coords[1] = y;
      } else if (x.constructor === Array || x.constructor === Float32Array) {
        this.coords[0] = x[0];
        this.coords[1] = x[1];
      } else if (typeof x === 'object' && ('x' in x || 'y' in x)) {
        this.coords[0] = x.x;
        this.coords[1] = x.y;
      } else {
        this.coords[0] = x;
        this.coords[1] = y;
      }
      return this;
    },
    translate: function(x, y) {
      var p = x instanceof Point ? x : new Point(x, y);
      if (!isNaN(p.coords[0])) {
        this.coords[0] += p.coords[0];
      }
      if (!isNaN(p.coords[1])) {
        this.coords[1] += p.coords[1];
      }
      return this;
    },
    translateX: function(x) {
      this.coords[0] += x;
      return this;
    },
    translateY: function(y) {
      this.coords[1] += y;
      return this;
    }
  });
  Point.prototype.onLine = function(knownCoord, p1, p2) {
    var origin = p1,
        vector = [p2.x - p1.x, p2.y - p1.y];
    if (knownCoord === 'x') {
      this.coords[1] = (this.coords[0] - origin.x) / vector[0] * vector[1] + origin.y;
    } else {
      this.coords[0] = (this.coords[1] - origin.y) / vector[1] * vector[0] + origin.x;
    }
  };
  var $__default = Point;
  return {
    get default() {
      return $__default;
    },
    __esModule: true
  };
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci82IiwiY2xhc3Nlcy9Qb2ludC5qcyIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci81IiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzQiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMCIsIkB0cmFjZXVyL2dlbmVyYXRlZC9UZW1wbGF0ZVBhcnNlci8zIiwiQHRyYWNldXIvZ2VuZXJhdGVkL1RlbXBsYXRlUGFyc2VyLzEiLCJAdHJhY2V1ci9nZW5lcmF0ZWQvVGVtcGxhdGVQYXJzZXIvMiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxLQUFLLEFBQUMsRUNBZSxlQUFjLEVDQW5DLFVBQVMsSUFBZ0I7O0FDQXpCLEtBQUksS0FBaUIsR0FBSyxFQUFDLGVBQTJCO0FBQzFDLFNBQW9CLEVBQUMsT0FBTSxNQUFtQixDQUFDLENBQUE7QUFBQSxJRkRwRCxTQUFPO0FBRWQsU0FBUyxNQUFJLENBQUcsQ0FBQSxDQUFHLENBQUEsQ0FBQSxDQUFJO0FBQ3RCLFdBQU8sVUFBVSxZQUFZLEtBQUssQUFBQyxDQUFFLElBQUcsQ0FBRSxDQUFDO0FBRTNDLE9BQUssQ0FBQyxDQUFBLENBQUEsRUFBSyxDQUFBLENBQUEsSUFBTSxFQUFBLENBQUk7QUFDcEIsU0FBRyxPQUFPLEVBQUksSUFBSSxhQUFXLEFBQUMsQ0FBQyxDQUFDLENBQUEsQ0FBRyxFQUFBLENBQUMsQ0FBQyxDQUFDO0lBRXZDLEtBQU8sS0FBSyxDQUFBLFlBQVksSUFBTSxNQUFJLENBQUEsRUFBSyxDQUFBLENBQUEsWUFBWSxJQUFNLGFBQVcsQ0FBSTtBQUN2RSxTQUFHLE9BQU8sRUFBSSxJQUFJLGFBQVcsQUFBQyxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBRWxDLEtBQU8sS0FBSyxNQUFPLEVBQUEsQ0FBQSxHQUFNLFNBQU8sQ0FBQSxFQUFLLEVBQUUsR0FBRSxHQUFLLEVBQUEsQ0FBQSxF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QUFLLEVBQUUsQ0FBQztJQUNsRixLQUFPO0FBQ04sU0FBRyxPQUFPLENBQUUsQ0FBQSxDQUFDLEVBQUksQ0FBQSxDQUFFLElBQUcsT0FBTyxDQUFFLENBQUEsQ0FBQyxFQUFJLENBQUEsTUFBSyxFQUFFLENBQUUsRUFBSSxDQUFBLE1BQUssQ0FBRSxDQUFBLENBQUMsQ0FBQSxDQUFJLENBQUEsTUFBSyxDQUFFLENBQUEsQ0FBQyxDQUFBLENBQUksQ0FBQSxNQUFLLEVBQUUsQ0FBQztJQUNsRjtBQUFBLEVBQ0QsQ0FBQztBRy9IRCxBQUFJLElBQUEsQ0FBQSxVQUFTLEVIaUlFLE1HaklrQixBSGlJZCxDR2pJYztBQ0FqQztBQ0FBLGdCQUF3QjtBQUFFLHVCQUF3QjtJQUFFO0FDQXBELGFBQVMsQ0FBRyxLQUFHO0FBQUEsR0ZBUTtBSEVuQixDRkZ1QyxDQUFDO0FDb094QyIsImZpbGUiOiJjbGFzc2VzL1BvaW50LmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlc0NvbnRlbnQiOlsiZGVmaW5lKCRfX3BsYWNlaG9sZGVyX18wLCAkX19wbGFjZWhvbGRlcl9fMSk7IiwiaW1wb3J0IENsYXNzaWZ5IGZyb20gJy4vQ2xhc3NpZnkuanMnO1xuXG5mdW5jdGlvbiBQb2ludCggeCwgeSApIHtcblx0Q2xhc3NpZnkucHJvdG90eXBlLmNvbnN0cnVjdG9yLmNhbGwoIHRoaXMgKTtcblxuXHRpZiAoICF4ICYmIHggIT09IDAgKSB7XG5cdFx0dGhpcy5jb29yZHMgPSBuZXcgRmxvYXQzMkFycmF5KFt4LCB5XSk7XG5cblx0fSBlbHNlIGlmICggeC5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgfHwgeC5jb25zdHJ1Y3RvciA9PT0gRmxvYXQzMkFycmF5ICkge1xuXHRcdHRoaXMuY29vcmRzID0gbmV3IEZsb2F0MzJBcnJheSh4KTtcblxuXHR9IGVsc2UgaWYgKCB0eXBlb2YgeCA9PT0gJ29iamVjdCcgJiYgKCAneCcgaW4geCB8fCAneScgaW4geCApICkge1xuXHRcdHRoaXMuY29vcmRzID0gbmV3IEZsb2F0MzJBcnJheShbeC54LCB4LnldKTtcblxuXHR9IGVsc2Uge1xuXHRcdHRoaXMuY29vcmRzID0gbmV3IEZsb2F0MzJBcnJheShbeCwgeV0pO1xuXG5cdH1cbn1cblxuUG9pbnQucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShDbGFzc2lmeS5wcm90b3R5cGUpO1xuUG9pbnQucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gUG9pbnQ7XG5cbk9iamVjdC5taXhpbihQb2ludC5wcm90b3R5cGUsIHtcblxuXHQvLyAueCBhbmQgLnkgYXJlIG1vcmUgY29udmVuaWVudCB0aGFuIC5jb29yZHNbMF0gYW5kIC5jb29yZHNbMV1cblx0Z2V0IHgoKSB7XG5cdFx0cmV0dXJuIHRoaXMuY29vcmRzWzBdO1xuXHR9LFxuXHRzZXQgeCggeCApIHtcblx0XHR0aGlzLmNvb3Jkc1swXSA9IHg7XG5cdH0sXG5cdGdldCB5KCkge1xuXHRcdHJldHVybiB0aGlzLmNvb3Jkc1sxXTtcblx0fSxcblx0c2V0IHkoIHkgKSB7XG5cdFx0dGhpcy5jb29yZHNbMV0gPSB5O1xuXHR9LFxuXG5cdHNldCh4LCB5KSB7XG5cdFx0dGhpcy5jb29yZHNbMF0gPSB4O1xuXHRcdHRoaXMuY29vcmRzWzFdID0geTtcblx0fSxcblxuXHR0cmFuc2Zvcm0oIG0gKSB7XG5cdFx0dmFyIGNvb3JkczAgPSB0aGlzLmNvb3Jkc1swXTtcblx0XHR0aGlzLmNvb3Jkc1swXSA9IG1bMF0gKiBjb29yZHMwICsgbVsyXSAqIHRoaXMuY29vcmRzWzFdICsgbVs0XTtcblx0XHR0aGlzLmNvb3Jkc1sxXSA9IG1bMV0gKiBjb29yZHMwICsgbVszXSAqIHRoaXMuY29vcmRzWzFdICsgbVs1XTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHRvU3RyaW5nKCkge1xuXHRcdHJldHVybiAoIGlzTmFOKCB0aGlzLmNvb3Jkc1swXSApID8gJ05hTicgOiBNYXRoLnJvdW5kKCB0aGlzLmNvb3Jkc1swXSApICkgK1xuXHRcdFx0JyAnICtcblx0XHRcdCggaXNOYU4oIHRoaXMuY29vcmRzWzFdICkgPyAnTmFOJyA6IE1hdGgucm91bmQoIHRoaXMuY29vcmRzWzFdICkgKTtcblx0fSxcblxuXHR0b0pTT04oKSB7XG5cdFx0cmV0dXJuIHRoaXMudG9TdHJpbmcoKTtcblx0fSxcblxuXG5cblx0Ly8gVGhlIGZvbGxvd2luZyBtZXRob2RzIGFyZSBkZXByZWNhdGVkXG5cblx0Ly8gYSBzZXR0ZXIgZm9yIHgveSBjb29yZGluYXRlcyB0aGF0IGJlaGF2ZXMgZXhhY3RseSBsaWtlIHRoZSBjb25zdHJ1Y3RvclxuXHRfKHgsIHkpIHtcblx0XHRpZiAoIHggPT09IHVuZGVmaW5lZCB8fMKgeCA9PT0gbnVsbCApIHtcblx0XHRcdHRoaXMuY29vcmRzWzBdID0geDtcblx0XHRcdHRoaXMuY29vcmRzWzFdID0geTtcblxuXHRcdH0gZWxzZSBpZiAoIHguY29uc3RydWN0b3IgPT09IEFycmF5IHx8IHguY29uc3RydWN0b3IgPT09IEZsb2F0MzJBcnJheSApIHtcblx0XHRcdHRoaXMuY29vcmRzWzBdID0geFswXTtcblx0XHRcdHRoaXMuY29vcmRzWzFdID0geFsxXTtcblxuXHRcdH0gZWxzZSBpZiAoIHR5cGVvZiB4ID09PSAnb2JqZWN0JyAmJiAoICd4JyBpbiB4IHx8ICd5JyBpbiB4ICkgKSB7XG5cdFx0XHR0aGlzLmNvb3Jkc1swXSA9IHgueDtcblx0XHRcdHRoaXMuY29vcmRzWzFdID0geC55O1xuXG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29vcmRzWzBdID0geDtcblx0XHRcdHRoaXMuY29vcmRzWzFdID0geTtcblxuXHRcdH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHRyYW5zbGF0ZSggeCwgeSApIHtcblx0XHR2YXIgcCA9IHggaW5zdGFuY2VvZiBQb2ludCA/XG5cdFx0XHRcdHg6XG5cdFx0XHRcdG5ldyBQb2ludCggeCwgeSApO1xuXG5cdFx0aWYgKCAhaXNOYU4oIHAuY29vcmRzWzBdICkgKSB7XG5cdFx0XHR0aGlzLmNvb3Jkc1swXSArPSBwLmNvb3Jkc1swXTtcblx0XHR9XG5cdFx0aWYgKCAhaXNOYU4oIHAuY29vcmRzWzFdICkgKSB7XG5cdFx0XHR0aGlzLmNvb3Jkc1sxXSArPSBwLmNvb3Jkc1sxXTtcblx0XHR9XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHR0cmFuc2xhdGVYKCB4ICkge1xuXHRcdHRoaXMuY29vcmRzWzBdICs9IHg7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0dHJhbnNsYXRlWSggeSApIHtcblx0XHR0aGlzLmNvb3Jkc1sxXSArPSB5O1xuXHRcdHJldHVybiB0aGlzO1xuXHR9XG59KTtcblxuUG9pbnQucHJvdG90eXBlLm9uTGluZSA9IGZ1bmN0aW9uKCBrbm93bkNvb3JkLCBwMSwgcDIgKSB7XG5cdHZhciBvcmlnaW4gPSBwMSxcblx0XHR2ZWN0b3IgPSBbXG5cdFx0XHRwMi54IC0gcDEueCxcblx0XHRcdHAyLnkgLSBwMS55XG5cdFx0XTtcblxuXHRpZiAoIGtub3duQ29vcmQgPT09ICd4JyApIHtcblx0XHR0aGlzLmNvb3Jkc1sxXSA9ICggdGhpcy5jb29yZHNbMF0gLSBvcmlnaW4ueCApIC8gdmVjdG9yWzBdICogdmVjdG9yWzFdICsgb3JpZ2luLnk7XG5cdH0gZWxzZSB7XG5cdFx0dGhpcy5jb29yZHNbMF0gPSAoIHRoaXMuY29vcmRzWzFdIC0gb3JpZ2luLnkgKSAvIHZlY3RvclsxXSAqIHZlY3RvclswXSArIG9yaWdpbi54O1xuXHR9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBQb2ludDtcblxuXHQvLyBcdHJldHVybiBQb2ludDtcblx0Ly8gfSk7XG5cblx0Ly8gc29tZSBmdW5jdGlvbnMgbmVlZCB0byBiZSBhZGRlZCB0byB0aGUgcHJvdG90eXBlIGF0IHJ1bnRpbWUgdG8gYXZvaWQgY2lyY3VsYXIgZGVwZW5kZW5jeVxuXHQvKi5ydW4oZnVuY3Rpb24oUG9pbnQsIHBvaW50T24pIHtcblx0XHRQb2ludC5wcm90b3R5cGUub24gPSBwb2ludE9uO1xuXHR9KVxuXG5cdC5mYWN0b3J5KCdwb2ludE9uJywgZnVuY3Rpb24oIFBvaW50LCBsaW5lTGluZUludGVyc2VjdGlvbiApIHtcblx0XHQvLyB0aGlzIHJlZ2V4cCBpcyBkdXBsaWNhdGVkIGluIFNlZ21lbnQuanNcblx0XHR2YXIgcnN0cmFpZ2h0ID0gL1tMVk1IXS87XG5cblx0XHRyZXR1cm4gZnVuY3Rpb24oIGFyZ3MgKSB7XG5cdFx0XHR2YXIgb3JpZ2luLFxuXHRcdFx0XHR2ZWN0b3I7XG5cblx0XHRcdC8vIGhhbmRsZSBjYXNlcyB3aGVyZSBhcmdzIHJlZmVycyB0byB1bmRlZmluZWQgZGF0YVxuXHRcdFx0aWYgKCBhcmdzID09PSB1bmRlZmluZWQgfHwgKCBhcmdzLmNvbnN0cnVjdG9yID09PSBBcnJheSAmJiAoIGFyZ3NbMF0gPT09IHVuZGVmaW5lZCB8fCBhcmdzWzFdID09PSB1bmRlZmluZWQgKSApICkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcztcblx0XHRcdH1cblxuXHRcdFx0Ly8gcG9pbnQgb24gYSBzZWdtZW50XG5cdFx0XHRpZiAoICFpc05hTiggdGhpcy5jb29yZHNbMF0gKSB8fCAhaXNOYU4oIHRoaXMuY29vcmRzWzFdICkgKSB7XG5cblx0XHRcdFx0Ly8gcG9pbnQgb24gYSBzdHJhaWdodCBsaW5lXG5cdFx0XHRcdGlmICggKCBhcmdzLmNvbW1hbmQgIT09IHVuZGVmaW5lZCAmJiByc3RyYWlnaHQudGVzdChhcmdzLmNvbW1hbmQpICkgfHxcblx0XHRcdFx0XHRhcmdzLmNvbnN0cnVjdG9yID09PSBBcnJheSApIHtcblx0XHRcdFx0XHQvLyBzZWdtZW50IGZyb20gdHdvIHBvaW50c1xuXHRcdFx0XHRcdGlmICggYXJncy5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgKSB7XG5cdFx0XHRcdFx0XHRvcmlnaW4gPSBhcmdzWzBdO1xuXHRcdFx0XHRcdFx0dmVjdG9yID0gW1xuXHRcdFx0XHRcdFx0XHRhcmdzWzFdLnggLSBhcmdzWzBdLngsXG5cdFx0XHRcdFx0XHRcdGFyZ3NbMV0ueSAtIGFyZ3NbMF0ueVxuXHRcdFx0XHRcdFx0XTtcblxuXHRcdFx0XHRcdC8vIFNlZ21lbnQgaW5zdGFuY2Vcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0b3JpZ2luID0gYXJncy5zdGFydDtcblx0XHRcdFx0XHRcdHZlY3RvciA9IFtcblx0XHRcdFx0XHRcdFx0YXJncy5lbmQueCAtIGFyZ3Muc3RhcnQueCxcblx0XHRcdFx0XHRcdFx0YXJncy5lbmQueSAtIGFyZ3Muc3RhcnQueVxuXHRcdFx0XHRcdFx0XTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZiAoIHRoaXMuY29vcmRzWzBdICkge1xuXHRcdFx0XHRcdFx0dGhpcy5jb29yZHNbMV0gPSAoIHRoaXMuY29vcmRzWzBdIC0gb3JpZ2luLnggKSAvIHZlY3RvclswXSAqIHZlY3RvclsxXSArIG9yaWdpbi55O1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLmNvb3Jkc1swXSA9ICggdGhpcy5jb29yZHNbMV0gLSBvcmlnaW4ueSApIC8gdmVjdG9yWzFdICogdmVjdG9yWzBdICsgb3JpZ2luLng7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cblx0XHRcdFx0Ly8gcG9pbnQgb24gYSBjdXJ2ZVxuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0Ly8gaW50ZXJzZWN0aW9uXG5cdFx0XHR9IGVsc2UgaWYgKCBhcmdzLmNvbnN0cnVjdG9yID09PSBBcnJheSAmJiBhcmdzLmxlbmd0aCA9PT0gMiApIHtcblxuXHRcdFx0XHQvLyBsaW5lLWxpbmUgaW50ZXJzZWN0aW9uXG5cdFx0XHRcdGlmIChcdCggYXJnc1swXS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgfHwgcnN0cmFpZ2h0LnRlc3QoYXJnc1swXS5jb21tYW5kKSApICYmXG5cdFx0XHRcdFx0XHQoIGFyZ3NbMV0uY29uc3RydWN0b3IgPT09IEFycmF5IHx8IHJzdHJhaWdodC50ZXN0KGFyZ3NbMV0uY29tbWFuZCkgKSApIHtcblxuXHRcdFx0XHRcdHZhciBwMSA9IGFyZ3NbMF0uY29uc3RydWN0b3IgPT09IEFycmF5ID9cblx0XHRcdFx0XHRcdFx0KCBhcmdzWzBdWzBdIGluc3RhbmNlb2YgUG9pbnQgP1xuXHRcdFx0XHRcdFx0XHRcdGFyZ3NbMF1bMF06XG5cdFx0XHRcdFx0XHRcdFx0bmV3IFBvaW50KCBhcmdzWzBdWzBdICkgKTpcblx0XHRcdFx0XHRcdFx0YXJnc1swXS5zdGFydCxcblx0XHRcdFx0XHRcdHAyID0gYXJnc1swXS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgP1xuXHRcdFx0XHRcdFx0XHQoIGFyZ3NbMF1bMV0gaW5zdGFuY2VvZiBQb2ludCA/XG5cdFx0XHRcdFx0XHRcdFx0YXJnc1swXVsxXTpcblx0XHRcdFx0XHRcdFx0XHRuZXcgUG9pbnQoIGFyZ3NbMF1bMV0gKSApOlxuXHRcdFx0XHRcdFx0XHRhcmdzWzBdLmVuZCxcblx0XHRcdFx0XHRcdHAzID0gYXJnc1sxXS5jb25zdHJ1Y3RvciA9PT0gQXJyYXkgP1xuXHRcdFx0XHRcdFx0XHQoIGFyZ3NbMV1bMF0gaW5zdGFuY2VvZiBQb2ludCA/XG5cdFx0XHRcdFx0XHRcdFx0YXJnc1sxXVswXTpcblx0XHRcdFx0XHRcdFx0XHRuZXcgUG9pbnQoIGFyZ3NbMV1bMF0gKSApOlxuXHRcdFx0XHRcdFx0XHRhcmdzWzFdLnN0YXJ0LFxuXHRcdFx0XHRcdFx0cDQgPSBhcmdzWzFdLmNvbnN0cnVjdG9yID09PSBBcnJheSA/XG5cdFx0XHRcdFx0XHRcdCggYXJnc1sxXVsxXSBpbnN0YW5jZW9mIFBvaW50ID9cblx0XHRcdFx0XHRcdFx0XHRhcmdzWzFdWzFdOlxuXHRcdFx0XHRcdFx0XHRcdG5ldyBQb2ludCggYXJnc1sxXVsxXSApICk6XG5cdFx0XHRcdFx0XHRcdGFyZ3NbMV0uZW5kO1xuXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuXyggbGluZUxpbmVJbnRlcnNlY3Rpb24oIHAxLCBwMiwgcDMsIHA0ICkgKTtcblxuXHRcdFx0XHQvLyBjdXJ2ZS1jdXJ2ZSBpbnRlcnNlY3Rpb25cblx0XHRcdFx0fSBlbHNlIGlmICggYXJnc1swXS5jb21tYW5kID09PSAnQycgJiYgYXJnc1sxXS5jb21tYW5kID09PSAnQycgKSB7XG5cblx0XHRcdFx0Ly8gbGluZS1jdXJ2ZSBvciBjdXJ2ZS1saW5lIGludGVyc2VjdGlvblxuXHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdH1cblxuXHRcdFx0fVxuXHRcdH07XG5cdH0pKi8iLCJmdW5jdGlvbigkX19wbGFjZWhvbGRlcl9fMCkge1xuICAgICAgJF9fcGxhY2Vob2xkZXJfXzFcbiAgICB9IiwiaWYgKCEkX19wbGFjZWhvbGRlcl9fMCB8fCAhJF9fcGxhY2Vob2xkZXJfXzEuX19lc01vZHVsZSlcbiAgICAgICAgICAgICRfX3BsYWNlaG9sZGVyX18yID0ge2RlZmF1bHQ6ICRfX3BsYWNlaG9sZGVyX18zfSIsInZhciAkX19kZWZhdWx0ID0gJF9fcGxhY2Vob2xkZXJfXzAiLCJyZXR1cm4gJF9fcGxhY2Vob2xkZXJfXzAiLCJnZXQgJF9fcGxhY2Vob2xkZXJfXzAoKSB7IHJldHVybiAkX19wbGFjZWhvbGRlcl9fMTsgfSIsIl9fZXNNb2R1bGU6IHRydWUiXX0=